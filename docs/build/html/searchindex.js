Search.setIndex({"docnames": ["index", "vertopal.com_transformerlensdemo"], "filenames": ["index.rst", "vertopal.com_transformerlensdemo.md"], "titles": ["Transformer Lens Documentation", "Transformer Lens Main Demo Notebook"], "terms": {"index": 1, "modul": 1, "search": 1, "page": 1, "hello": 1, "world": 1, "lu": 0, "make": [0, 1], "i": 0, "python": [0, 1], "librari": 0, "cook": 0, "food": 0, "lover": 0, "creat": [0, 1], "recip": 0, "mix": [0, 1], "random": [0, 1], "ingredi": 0, "It": [0, 1], "pull": 0, "data": [0, 1], "from": [0, 1], "open": 0, "fact": [0, 1], "databas": 0, "offer": 0, "simpl": [0, 1], "intuit": [0, 1], "api": 0, "check": [0, 1], "out": [0, 1], "usag": 0, "section": [0, 1], "further": [0, 1], "inform": [0, 1], "includ": 0, "how": [0, 1], "instal": [0, 1], "project": 0, "thi": [0, 1], "under": 0, "activ": 0, "develop": [0, 1], "hi": 1, "test": 1, "asldkalkdsl": [], "teadsa": [], "test2": [], "2": 1, "transform": [], "len": [], "main": 0, "demo": 0, "notebook": 0, "To": 1, "us": 1, "go": 1, "runtim": 1, "chang": 1, "type": 1, "select": 1, "gpu": 1, "hardwar": 1, "acceler": 1, "tip": 1, "read": 1, "colab": 1, "you": 1, "can": 1, "run": 0, "all": 0, "code": 1, "yourself": 1, "The": 1, "graph": 1, "ar": 1, "interact": 1, "tabl": 1, "content": 1, "pane": 1, "sidebar": 1, "navig": 1, "collaps": 1, "irrelev": 1, "dropdown": 1, "arrow": 1, "ctrl": 1, "f": 1, "setup": 0, "No": 1, "need": 1, "janki": 1, "do": 1, "differ": 1, "when": 1, "v": 1, "vscode": 1, "development_mod": 1, "fals": 1, "try": 1, "import": 0, "googl": 1, "in_colab": 1, "true": 1, "print": 1, "pip": 1, "git": 1, "http": 1, "github": 1, "com": 1, "neelnanda": 1, "io": 1, "transformerlen": 1, "circuitsvi": 1, "pysvelt": 1, "an": 0, "unmaintain": 1, "visual": 1, "backup": 1, "isn": 1, "t": 1, "work": 1, "anoth": 1, "version": 1, "node": 1, "wai": 1, "faster": 1, "curl": 1, "fssl": 1, "deb": 1, "nodesourc": 1, "setup_16": 1, "x": 1, "sudo": 1, "e": 1, "bash": 1, "apt": 1, "get": 1, "y": 1, "nodej": 1, "except": 1, "jupyt": 1, "intend": 1, "onli": 1, "ipython": 1, "get_ipython": 1, "automat": 1, "updat": 1, "hookedtransform": 1, "its": 1, "edit": 1, "without": 1, "restart": 1, "kernel": 1, "magic": 1, "load_ext": 1, "autoreload": 1, "plotli": 1, "render": 1, "argh": 1, "pio": 1, "default": 1, "els": 1, "notebook_connect": 1, "cv": 1, "exampl": 0, "neel": 1, "util": 1, "renderedhtml": [], "0x7f96ad0fdcd0": [], "stuff": 1, "torch": 1, "nn": 1, "function": 1, "optim": 1, "numpi": 1, "np": 1, "einop": 1, "fancy_einsum": 1, "einsum": 1, "tqdm": 1, "auto": 1, "pathlib": 1, "path": 1, "express": 1, "px": 1, "dataload": 1, "torchtyp": 1, "tensortyp": 1, "tt": 1, "list": 1, "union": 1, "option": 1, "functool": 1, "partial": 1, "copi": 0, "itertool": 1, "automodelforcausallm": 1, "autoconfig": 1, "autotoken": 1, "dataclass": 1, "dataset": 1, "displai": 1, "html": 1, "transformer_len": 1, "hook_point": 1, "hookedrootmodul": 1, "hookpoint": 1, "hook": 0, "hookedtransformerconfig": 1, "factoredmatrix": 1, "activationcach": 1, "we": 1, "turn": 1, "differenti": 1, "off": 1, "save": 1, "memori": 1, "focus": 1, "model": 0, "infer": 1, "train": 0, "set_grad_en": 1, "autograd": [], "grad_mod": [], "0x7f973be365d0": [], "plot": 1, "helper": 1, "def": 1, "imshow": 1, "tensor": 1, "none": 1, "xaxi": 1, "yaxi": 1, "kwarg": 1, "to_numpi": 1, "color_continuous_midpoint": 1, "0": 1, "color_continuous_scal": 1, "rdbu": 1, "label": 1, "show": 1, "line": 1, "scatter": 1, "caxi": 1, "color": 1, "introduct": 0, "nanda": 1, "wrote": 1, "mechanist": 1, "interpret": 0, "gpt": 1, "style": 1, "languag": 1, "goal": 1, "take": 1, "revers": 1, "engin": 1, "algorithm": 1, "learn": 1, "dure": 1, "weight": 1, "about": 1, "todai": 1, "have": 1, "comput": 1, "program": 1, "essenti": 1, "speak": 1, "english": 1, "human": 1, "level": 1, "3": 1, "palm": 1, "etc": 1, "yet": 1, "idea": 1, "thei": 1, "nor": 1, "write": 1, "one": 1, "ourselv": 1, "offend": 1, "me": 1, "greatli": 1, "would": 1, "like": 1, "solv": 1, "veri": 1, "young": 1, "small": 1, "field": 1, "lot": 1, "problem": 1, "help": 1, "pleas": 1, "If": 1, "want": 1, "skill": 1, "up": 1, "my": 1, "guid": 1, "start": 1, "jump": 1, "sequenc": 1, "200": 1, "concret": 1, "becaus": 1, "after": 1, "left": 1, "anthrop": 1, "team": 1, "independ": 1, "research": 1, "got": 1, "extrem": 1, "frustrat": 1, "state": 1, "sourc": 0, "tool": 1, "There": 1, "": 1, "excel": 1, "infrastructur": 1, "huggingfac": 1, "deepspe": 1, "littl": 1, "dig": 1, "intern": 1, "tri": 1, "easi": 1, "even": 1, "don": 1, "industri": 1, "org": 1, "real": 1, "core": 1, "featur": 0, "were": 1, "heavili": 1, "inspir": 1, "garcon": 1, "credit": 1, "nelson": 1, "elhag": 1, "chri": 1, "olah": 1, "build": 1, "valu": 1, "good": 1, "exploratori": 1, "design": 1, "principl": 1, "ve": 0, "follow": 1, "enabl": 1, "analysi": 1, "most": 1, "fun": 1, "part": 1, "compar": 1, "normal": 1, "ml": 1, "short": 1, "feedback": 1, "loop": 1, "point": 0, "keep": 1, "gap": 1, "between": 1, "experi": 1, "see": 1, "result": 1, "possibl": 1, "feel": 1, "plai": 1, "enter": 1, "flow": 1, "demonstr": 1, "well": 1, "analys": 1, "indirect": 0, "object": 0, "identif": 0, "record": 1, "myself": 1, "load": 0, "come": 1, "40": 1, "ani": 1, "them": 1, "from_pretrain": 1, "model_nam": 1, "For": 0, "ll": 1, "look": 1, "80m": 1, "paramet": 0, "avail": 0, "info": 1, "rest": 1, "devic": 1, "cuda": 1, "is_avail": 1, "cpu": 1, "gpt2": 1, "pad_token": 1, "set": 1, "pretrain": 1, "let": 1, "find": 1, "loss": 1, "text": 0, "singl": 1, "string": 1, "token": 0, "shape": 1, "batch": 1, "posit": 1, "integ": 1, "return": 1, "logit": 1, "d_vocab": 1, "float": 1, "cross": 1, "entropi": 1, "predict": 1, "next": 1, "both": 1, "tupl": 1, "calcul": 1, "intermedi": 1, "model_description_text": [], "explain": [], "document": 1, "support": 1, "hyper": 1, "name": 0, "each": 1, "consist": 1, "architectur": 0, "clean": 1, "friendli": 0, "paragraph": 1, "return_typ": [], "4": 1, "1653": 1, "cach": 0, "first": 1, "basic": 0, "oper": 1, "break": 1, "black": 1, "box": 1, "done": 1, "run_with_cach": 1, "abstract": 1, "paper": 1, "On": [], "remove_batch_dim": 1, "everi": 1, "insid": 1, "begin": 1, "dimens": 1, "here": 1, "alwai": 1, "length": 1, "1": 1, "kinda": 1, "annoi": 1, "so": 1, "pass": 1, "keyword": 1, "remov": 1, "gpt2_cache_no_batch_dim": 1, "gpt2_cach": 1, "achiev": 1, "same": 1, "effect": 1, "detail": 1, "gpt2_text": 1, "natur": 1, "process": 1, "task": 0, "question": 1, "answer": 1, "machin": 1, "translat": 1, "comprehens": 1, "summar": 1, "typic": 1, "approach": 1, "supervis": 1, "taskspecif": 1, "gpt2_token": 1, "to_token": 1, "gpt2_logit": 1, "attent": 1, "pattern": 1, "head": 0, "layer": 1, "alan": 1, "coonei": 1, "base": 1, "call": 1, "attn": 1, "ha": 1, "head_index": 1, "destination_posit": 1, "source_posit": 1, "to_str_token": 1, "method": 1, "convert": 1, "sinc": 1, "pair": 1, "hover": 1, "over": 1, "click": 1, "lock": 1, "grid": 1, "top": 1, "destin": 1, "lower": 1, "triangular": 1, "causal": 1, "backward": 1, "move": 1, "forward": 1, "network": 1, "more": 1, "what": 1, "attention_pattern": 1, "gpt2_str_token": 1, "class": 0, "size": 1, "12": 1, "33": 1, "current": 1, "just": 1, "fork": 1, "parallel": 1, "alreadi": 1, "been": 1, "disabl": 1, "avoid": 1, "deadlock": 1, "warn": 1, "either": 1, "befor": 1, "explicitli": 1, "environ": 1, "variabl": 1, "tokenizers_parallel": 1, "0x7f96781e7790": [], "interven": 0, "One": 1, "great": 1, "thing": 1, "neural": 1, "full": 1, "control": 1, "our": 1, "system": 1, "perspect": 1, "know": 1, "exactli": 1, "mean": 1, "And": 1, "precis": 1, "surgic": 1, "behaviour": 1, "other": 0, "power": 1, "u": 1, "eg": 1, "care": 1, "counterfactu": 1, "intervent": 1, "easili": 1, "understand": 1, "accordingli": 1, "being": 1, "abl": 1, "pretti": 1, "kei": 1, "surround": 1, "which": 1, "allow": 1, "ad": 1, "map": 1, "current_activation_valu": 1, "new_activation_valu": 1, "As": 1, "appli": 1, "replac": 1, "substitut": 1, "arbitrari": 1, "long": 1, "correct": 1, "relationship": 1, "pytorch": 1, "blog": [], "paperspac": [], "gradient": [], "clip": [], "debug": [], "underr": [], "incredibli": [], "act": 1, "input": 1, "output": 1, "autodiff": [], "within": 1, "structur": 1, "immedi": 1, "clear": [], "adjust": [], "wa": 1, "shamelessli": [], "probepoint": [], "circuit": 1, "pub": [], "2021": [], "also": 1, "rang": 1, "qualiti": [], "life": [], "improv": 1, "reset_hook": 1, "temporarili": 1, "add": 1, "shoot": 1, "foot": 1, "standard": 1, "ablat": 1, "7": 1, "abov": 1, "defin": 1, "head_ablation_hook": 1, "compon": 1, "zero": 1, "note": 1, "convent": 1, "re": 1, "place": 1, "strictli": 1, "run_with_hook": 1, "found": 1, "get_act_nam": 1, "layer_to_abl": [], "head_index_to_abl": [], "8": 1, "annot": [], "NOT": [], "necessari": 1, "reader": [], "po": [], "d_head": 1, "original_loss": [], "ablated_loss": [], "fwd_hook": [], "origin": 1, "item": [], "3f": [], "64": 1, "999": 1, "117": 1, "gotcha": 0, "global": 1, "stai": 1, "until": 1, "where": 1, "local": 1, "end": 1, "But": 1, "error": 1, "your": 1, "never": 1, "finish": 1, "bug": 1, "own": 1, "add_hook": 1, "relev": 1, "patch": 0, "somewhat": 1, "involv": 1, "ioi": 1, "identifi": 1, "sentenc": 1, "john": 1, "mari": 1, "went": 1, "store": 1, "gave": 1, "bottl": 1, "milk": 1, "rather": 1, "than": 1, "ie": 1, "redwood": 1, "studi": 1, "underli": 1, "techniqu": 1, "kevin": 1, "meng": 1, "david": 1, "bau": 1, "rome": 1, "complet": 1, "prompt": 1, "corrupt": 1, "metric": 1, "perform": 1, "pick": 1, "specif": 1, "much": 1, "recov": 1, "incorrect": 1, "final": 1, "significantli": 1, "neg": 1, "capabl": 1, "clean_prompt": [], "corrupted_prompt": [], "clean_token": [], "corrupted_token": [], "logits_to_logit_diff": [], "correct_answ": [], "incorrect_answ": [], "to_single_token": 1, "rais": [], "correct_index": [], "incorrect_index": [], "later": [], "clean_logit": [], "clean_cach": [], "clean_logit_diff": [], "corrupted_logit": [], "corrupted_logit_diff": [], "276": 1, "738": 1, "now": 1, "residu": 1, "stream": 1, "repres": 1, "iter": 1, "must": 1, "signatur": 1, "choos": 1, "resid_pr": [], "residual_stream_patching_hook": [], "d_model": 1, "int": [], "attribut": [], "give": 1, "clean_resid_pr": [], "put": 1, "slow": [], "num_posit": [], "ioi_patching_result": [], "cfg": [], "n_layer": 1, "temporari": [], "fix": 1, "temp_hook_fn": [], "patched_logit": [], "patched_logit_diff": [], "detach": [], "ish": 1, "version_major": [], "version_minor": [], "model_id": [], "69225f8c0e1949b8a900aa73abcdd5d4": [], "localis": 1, "initi": 1, "second": 1, "subject": 1, "matter": 1, "remain": 1, "9": 1, "doesn": 1, "duplic": [], "token_label": [], "_": 1, "enumer": [], "titl": [], "access": 0, "some": 0, "noth": 1, "extract": 1, "across": 1, "mani": 1, "neuron": 1, "everyth": 1, "could": 1, "post": 1, "workflow": 1, "effici": 1, "induct": 0, "gener": 0, "detect": 1, "continu": 1, "repeat": 1, "subsequ": 1, "two": 1, "separ": 1, "compos": 1, "togeth": 1, "previou": 1, "attend": 1, "earlier": 1, "why": 1, "sai": 1, "new": 1, "articl": 1, "michael": 1, "jordan": 1, "surnam": 1, "occur": 1, "confid": 1, "interest": 1, "generalis": 1, "50": 1, "twice": 1, "averag": 1, "goe": 1, "terribl": 1, "halfwai": 1, "batch_siz": [], "10": 1, "seq_len": 1, "random_token": [], "randint": [], "1000": 1, "10000": [], "repeated_token": [], "repeated_logit": [], "correct_log_prob": [], "loss_fn": [], "per_token": [], "loss_by_posit": [], "reduc": [], "49": 1, "back": 1, "paid": 1, "technic": 1, "attach": 1, "big": 1, "per": 1, "stack": [], "manipul": [], "score": 0, "appropri": [], "time": 1, "filter": 1, "boolean": 1, "evalu": [], "act_nam": [], "hook_funct": [], "onc": [], "induction_score_stor": [], "n_head": 1, "induction_score_hook": [], "dest_po": [], "source_po": [], "diagon": [], "entri": [], "induction_strip": [], "dim1": [], "dim2": [], "offset": [], "induction_scor": [], "pattern_hook_names_filt": [], "lambda": [], "endswith": [], "5": 1, "highli": 1, "feed": 1, "shorter": 1, "directli": 1, "stripe": 1, "induction_head_lay": [], "induction_head_index": [], "single_random_sequ": [], "20": 1, "repeated_random_sequ": [], "visualize_pattern_hook": [], "dummi": [], "axi": 1, "expect": 1, "3d": [], "0x7f96783b37d0": [], "toi": 0, "tini": 1, "four": 1, "solu": 1, "medium": 0, "300m": 1, "offici": 1, "alia": 1, "doe": 1, "multi": 1, "7b": 1, "soon": 1, "notabl": 1, "distilgpt": 1, "distil": 1, "half": 1, "distilgpt2": 1, "distilgpt2_induction_score_stor": [], "overview": 0, "classic": 1, "pre": 0, "openai": 1, "85m": 1, "larg": 1, "700m": 1, "xl": 1, "5b": 1, "22b": 1, "internet": 1, "replic": 1, "neo": 1, "eleuth": 1, "125m": 1, "3b": 1, "300b": 1, "pile": 1, "divers": 1, "bunch": 1, "weird": 1, "opt": 1, "meta": 1, "ai": 1, "seri": 1, "180b": 1, "6": 1, "13b": 1, "30b": 1, "66b": 1, "j": 1, "6b": 1, "neox": 1, "20b": 1, "stanford": 1, "crfm": 1, "seed": 1, "600": 1, "checkpoint": 0, "taken": 1, "checkpoint_index": 1, "265": 1, "free": 1, "reach": 1, "argument": 1, "given": 1, "A": 1, "mathemat": 1, "framework": 1, "4l": 1, "width": 1, "512": 1, "think": 1, "far": 1, "tractabl": 1, "larger": 1, "serv": 1, "practic": 1, "contain": 1, "motif": 1, "mlp": 1, "1l": 1, "2l": 1, "3l": 1, "gelu": 1, "80": 1, "c4": 1, "web": 1, "shuffl": 1, "scan": 1, "hope": 1, "easier": 1, "6l": 1, "40m": 1, "8l": 1, "100m": 1, "10l": 1, "200m": 1, "12l": 1, "340m": 1, "older": 1, "15b": 1, "13m": 1, "resourc": 0, "doc": 1, "thought": 1, "low": 1, "hang": 1, "fruit": 1, "peopl": 1, "usefulli": 1, "progress": 1, "toolkit": 1, "explor": 1, "mysteri": 1, "wild": 1, "codebas": 1, "arthur": 1, "conmi": 1, "alex": 1, "variengien": 1, "rigor": 1, "accompani": 1, "easytransform": 1, "similar": 1, "sever": 1, "made": 1, "walkthrough": 1, "whether": 1, "deriv": 1, "neuroscop": 1, "websit": 1, "sens": 1, "kind": 1, "tend": 1, "wiki": 1, "tutori": 1, "live": 1, "adapt": 1, "computation": 1, "ident": 1, "signific": 1, "w_k": 1, "w_q": 1, "w_v": 1, "queri": 1, "matric": 1, "concaten": 1, "w_o": 1, "z": 1, "ax": 1, "flatten": 1, "actual": 1, "bit": 1, "mess": 1, "varieti": 1, "flag": 1, "variou": 1, "famili": 1, "instead": 1, "recommend": 1, "cleantransformerdemo": 1, "By": 1, "multipli": 1, "right": 1, "new_activ": 1, "old_activ": 1, "bia": 1, "remind": 1, "param": 1, "number": 1, "block": 1, "768": 1, "d_mlp": 1, "3072": 1, "50267": 1, "vocabulari": 1, "n_ctx": 1, "1024": 1, "maximum": 1, "named_paramet": [], "startswith": [], "b_q": 1, "b_k": 1, "b_v": 1, "b_o": 1, "w_in": 1, "b_in": 1, "w_out": 1, "b_out": 1, "embed": 1, "unembed": 1, "emb": 1, "w_e": 1, "50257": 1, "pos_emb": 1, "w_po": 1, "unemb": 1, "w_u": 1, "b_u": 1, "In": 1, "fallback": 1, "spam": 1, "layernorm": 0, "scale": 1, "factor": 0, "deviat": 1, "element": 1, "ln1": 1, "ln2": 1, "ln_final": 1, "apart": 1, "dest_posit": 1, "unless": 1, "test_prompt": [], "quick": [], "brown": [], "fox": [], "lazi": [], "dog": [], "num": 1, "print_name_shape_hook_funct": [], "not_in_late_block_filt": [], "hook_emb": 1, "hook_pos_emb": 1, "hook_resid_pr": 1, "hook_scal": 1, "hook_norm": 1, "hook_q": 1, "hook_k": 1, "hook_v": 1, "hook_attn_scor": 1, "hook_pattern": 1, "hook_z": 1, "hook_attn_out": 1, "hook_resid_mid": 1, "hook_pr": 1, "hook_post": 1, "hook_mlp_out": 1, "hook_resid_post": 1, "fold": 0, "curiou": 0, "worth": 1, "especi": 1, "preconcept": 1, "analog": 1, "batchnorm": 1, "massiv": 1, "parallelis": 1, "realli": 1, "seem": 1, "numer": 1, "stabil": 1, "unlik": 1, "form": 1, "pain": 1, "overhead": 1, "deal": 0, "center_writing_weight": 1, "fold_ln": 1, "These": 1, "simplifi": 1, "vector": 1, "center": 1, "elementwis": 1, "linear": 1, "matrix": 0, "cannot": 1, "composit": 1, "consequ": 1, "particular": 1, "unigram": 1, "statist": 1, "rare": 1, "suppress": 1, "common": 1, "boost": 1, "dramat": 1, "degre": 1, "bottom": 1, "punctuat": 1, "word": 1, "ass": 1, "randomredditor": 1, "unembed_bia": [], "bias_valu": [], "bias_indic": [], "sort": [], "descend": [], "top_k": [], "2f": [], "repr": [], "to_str": 1, "03": 1, "98": 1, "68": 1, "48": 1, "n": 1, "47": 1, "41": 1, "25": 1, "16": 1, "04": 1, "88": 1, "72": 1, "59": 1, "52": 1, "45": 1, "44": 1, "82": 1, "\u30b5\u30fc\u30c6\u30a3": 1, "83": 1, "x18": 1, "x14": 1, "\u9f8d": 1, "x1b": 1, "x05": 1, "x00": 1, "x06": 1, "x07": 1, "x0c": 1, "x02": 1, "oreandonlin": 1, "84": 1, "x11": 1, "x10": 1, "favour": 1, "6x": 1, "john_bia": [], "mary_bia": [], "4f": [], "prob": 1, "ratio": 1, "exp": [], "8995": 1, "6034": 1, "6550x": 1, "mention": 1, "finit": 1, "solut": 1, "sub": 1, "broken": 1, "down": 1, "invert": 1, "de": 1, "get_token_posit": 1, "prepend_bo": 0, "figur": 1, "split": 1, "substr": 1, "observ": 1, "space": 1, "preced": 1, "capit": 1, "letter": 1, "fairli": 1, "while": 1, "uncommon": 1, "multipl": 1, "iz": 1, "mostli": 1, "charact": 1, "example_text": [], "example_text_str_token": [], "endoftext": 1, "str": 1, "ok": 1, "en": 1, "example_text_token": [], "50256": 1, "464": 1, "717": 1, "1517": 1, "345": 1, "761": 1, "284": 1, "3785": 1, "503": 1, "318": 1, "1635": 1, "4919": 1, "1243": 1, "389": 1, "11241": 1, "1143": 1, "13": 1, "4600": 1, "19849": 1, "1462": 1, "62": 1, "2536": 1, "482": 1, "641": 1, "63": 1, "30778": 1, "257": 1, "4731": 1, "656": 1, "262": 1, "16326": 1, "292": 1, "1351": 1, "286": 1, "850": 1, "37336": 1, "25666": 1, "290": 1, "523": 1, "8781": 1, "7301": 1, "644": 1, "2420": 1, "3073": 1, "588": 1, "1675": 1, "10176": 1, "428": 1, "11": 1, "1309": 1, "338": 1, "779": 1, "340": 1, "319": 1, "7322": 1, "pad": 1, "signifi": 1, "example_multi_text": [], "cat": 1, "sat": 1, "mat": 1, "hard": 1, "example_multi_text_token": [], "3797": 1, "3332": 1, "2603": 1, "1107": 1, "1327": 1, "conveni": 1, "correspond": 1, "log": 1, "implicitli": 1, "equival": [], "k": [], "cheat": [], "th": [], "treat": 1, "cat_text": [], "cat_logit": [], "cat_prob": [], "softmax": [], "dim": 1, "probabl": 1, "capital_the_token_index": [], "invers": 1, "256": 1, "due": 1, "ascii": 1, "verifi": 1, "squeez": [], "rank": 1, "relat": 1, "annoy": 1, "single_token": 1, "third": 1, "prepend": 1, "With": 1, "bo": 1, "mode": 1, "last": 1, "around": 1, "arithmet": 1, "digit": 1, "impress": 1, "2342": [], "2017": 1, "21445": [], "1000000": [], "999999": [], "23": 1, "42": 1, "214": 1, "000000": 1, "9999": 1, "99": 1, "investig": 1, "ideal": 1, "should": 1, "total": 1, "tim": 1, "ne": 1, "el": 1, "spend": 1, "earli": 1, "late": 1, "messier": 1, "takeawai": 1, "unexpect": 1, "mai": 1, "notic": 1, "trip": 1, "user": 1, "special": 1, "mark": 1, "confusingli": 1, "eo": 1, "hack": 1, "gone": 1, "forth": 1, "reason": 1, "weirdli": 1, "issu": 1, "distribut": 1, "simul": 1, "preserv": 1, "despit": 1, "empir": 1, "wors": 1, "ioi_logits_with_bo": [], "clair": 1, "shop": [], "mary_logit_with_bo": [], "claire_logit_with_bo": [], "ioi_logits_without_bo": [], "mary_logit_without_bo": [], "claire_logit_without_bo": [], "754": 1, "782": 1, "though": 1, "illustr": 1, "confus": 1, "cl": 1, "air": 1, "often": 1, "m": 1, "ab": 1, "b": 1, "implement": 1, "trace": 1, "eigenvalu": 0, "frobeniu": 1, "norm": 1, "singular": 1, "decomposit": 1, "product": 1, "approxim": 1, "drop": 1, "lead": 1, "argu": [], "best": [], "understood": [], "requisit": [], "w_qk": [], "determin": 1, "attention_scor": [], "whole": [], "bilinear": [], "w_ov": 1, "ignor": [], "smaller": [], "randn": [], "ab_factor": [], "rdim": [], "ldim": [], "hidden": 1, "mdim": [], "7439": 1, "omit": 1, "linalg": [], "eig": [], "svd": [], "6199e": 1, "00": 1, "0000e": 1, "00j": 1, "0446e": 1, "7190e": 1, "08": 1, "5998e": 1, "2859e": 1, "07j": 1, "6199": 1, "0446": 1, "4702e": 1, "7519e": 1, "4613e": 1, "07": 1, "0601e": 1, "8823e": 1, "09": 1, "4702": 1, "7519": 1, "smallest": 1, "along": 1, "c": [], "300": 1, "abc": [], "abc_factor": [], "unfactor": 1, "9906": 1, "properti": 1, "ab_unfactor": [], "isclos": [], "skip": 1, "aren": 1, "ov": 1, "factoris": 1, "subspac": 1, "mayb": 1, "happen": 1, "middl": 1, "minim": 1, "coincid": 1, "assert": 1, "eigenvector": 1, "direct": 1, "rotat": 1, "complex": 1, "negat": 1, "decent": 1, "proxi": 1, "frac": 1, "sum": 1, "lambda_i": 1, "ov_circuit_all_head": [], "ov_circuit_all_heads_eigenvalu": [], "dtype": [], "complex64": 1, "ov_copying_scor": [], "zmax": [], "zmin": [], "l11h11": 1, "high": 1, "imag": [], "imaginari": [], "absolut": 1, "enorm": 1, "few": 1, "full_ov_circuit": [], "full_ov_circuit_eigenvalu": [], "full_ov_copying_scor": [], "interestingli": 1, "perfectli": 1, "correl": 1, "sure": 1, "outlier": 1, "hover_nam": [], "l": [], "h": [], "thank": 1, "ansh": 1, "radhakrishnan": 1, "rough": 1, "establish": 1, "cnn": 1, "presid": 1, "barack": 1, "obama": 1, "caught": 1, "embarrass": 1, "scandal": 1, "max_new_token": [], "temperatur": [], "9c541056beba477db0a272faec9231b5": [], "ncnn": 1, "report": 1, "wednesdai": 1, "former": 1, "charg": 1, "ly": 1, "fbi": 1, "russian": 1, "employe": 1, "nthe": 1, "said": 1, "statement": 1, "had": 1, "conduct": 1, "nobama": 1, "plead": 1, "importantli": 1, "lightweight": 1, "bundl": 1, "wrap": 1, "root": 1, "inherit": 1, "interfac": 1, "syntax": 1, "old": 1, "scalar": 1, "squar": 1, "constant": 1, "x_0": 1, "x_1": 1, "x_2": 1, "squarethenadd": [], "__init__": [], "self": [], "super": [], "hook_squar": 1, "twolayermodel": [], "layer1": 1, "layer2": 1, "hook_in": 1, "hook_mid": 1, "hook_out": 1, "dictionari": 1, "leav": [], "unchang": [], "x_in": [], "x_mid": [], "x_out": [], "custom": 1, "wrapper": 1, "model_out": 1, "cache_object": 1, "manual": 1, "subset": 1, "780": 1, "28": 1, "784": 1, "set_to_zero_hook": [], "combin": 1, "dynam": 1, "throughout": 1, "num_checkpoint": 1, "checkpoint_valu": 1, "step": 1, "depend": 1, "piecewis": 1, "schedul": 1, "seen": 1, "100": 1, "crash": 1, "11b": 1, "truncat": 1, "centr": 1, "foundat": 1, "messi": 1, "hoc": 1, "count": 1, "get_checkpoint_label": 1, "tell": 1, "latter": 1, "loading_from_pretrain": [], "checkpoint_label": [], "checkpoint_label_typ": [], "log_i": [], "marker": [], "phase": 0, "transit": 0, "format": 1, "shift": 1, "brief": 1, "period": 1, "suddenli": 1, "becom": 1, "better": 1, "context": 1, "500": 1, "enough": 1, "visibl": 1, "bump": 1, "curv": 1, "rate": 1, "briefli": 1, "increas": 1, "exist": 1, "eval": 1, "induction_loss": 1, "deliber": 1, "non": 1, "purpos": 1, "384": 1, "justic": 1, "hand": 1, "chosen": 1, "indic": 1, "35": 1, "60": 1, "roughli": 1, "22m": 1, "500m": 1, "21": 1, "8b": 1, "through": 1, "respect": 1, "arbitrarili": [], "fast": [], "download": [], "specifi": [], "checkpoint_indic": [], "checkpointed_model": [], "tokens_trained_on": [], "model_for_this_checkpoint": [], "append": [], "tokens_seen_for_this_checkpoint": [], "induction_loss_for_this_checkpoint": [], "sharp": 1, "contextualis": 1, "uniformli": 1, "000": 1, "least": 1, "ln": 1, "20000": 1, "approx": 1, "naiv": 1, "strategi": 1, "randomli": 1, "appear": 1, "95": 1, "log_x": [], "cell": 1, "markdown": 1, "red": [], "execution_count": 1, "stdout": 1, "execute_result": 1, "stderr": 1, "14": 1, "15": 1, "display_data": 1, "17": 1, "18": 1, "19": 1, "22": 1, "24": 1, "26": 1, "27": 1, "29": 1, "30": 1, "31": 1, "32": 1, "34": 1, "36": 1, "37": 1, "38": 1, "39": 1, "43": 1, "46": 1, "51": 1, "53": 1, "54": 1, "55": 1, "56": 1, "57": 1, "58": 1, "div": 1, "id": 1, "vi": 1, "056bcb82": 1, "ac45": 1, "margin": 1, "15px": 1, "script": 1, "crossorigin": 1, "unpkg": 1, "dist": 1, "cdn": 1, "esm": 1, "lumach": 0}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": [], "jdbowma": [], "transform": [0, 1], "len": [0, 1], "doc": [], "": [], "document": 0, "indic": [], "tabl": [], "lumach": [], "content": 0, "your": [], "mama": [], "test2": [], "test": [], "2": [], "main": 1, "demo": 1, "notebook": 1, "setup": 1, "introduct": 1, "load": 1, "run": 1, "model": 1, "cach": 1, "all": 1, "activ": 1, "hook": 1, "interven": 1, "patch": 1, "indirect": 1, "object": 1, "identif": 1, "task": 1, "access": 1, "avail": 1, "an": 1, "overview": 1, "import": 1, "open": 1, "sourc": 1, "librari": 1, "some": 1, "interpret": 1, "friendli": 1, "i": 1, "ve": 1, "train": 1, "includ": 1, "other": 1, "resourc": 1, "architectur": 1, "paramet": 1, "name": 1, "fold": 1, "layernorm": 1, "For": 1, "curiou": 1, "featur": 1, "deal": 1, "token": 1, "gotcha": 1, "prepend_bo": 1, "factor": 1, "matrix": 1, "class": 1, "basic": 1, "exampl": 1, "medium": 1, "eigenvalu": 1, "copi": 1, "score": 1, "gener": 1, "text": 1, "point": 1, "toi": 1, "pre": 1, "checkpoint": 1, "induct": 1, "head": 1, "phase": 1, "transit": 1, "janki": [], "code": [], "do": [], "differ": [], "when": [], "colab": [], "v": [], "vscode": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Transformer Lens Documentation": [[0, "transformer-lens-documentation"]], "Contents": [[0, "contents"]], "Transformer Lens Main Demo Notebook": [[1, "transformer-lens-main-demo-notebook"]], "Setup": [[1, "setup"]], "Introduction": [[1, "introduction"]], "Loading and Running Models": [[1, "loading-and-running-models"]], "Caching all Activations": [[1, "caching-all-activations"]], "Hooks: Intervening on Activations": [[1, "hooks-intervening-on-activations"]], "Activation Patching on the Indirect Object Identification Task": [[1, "activation-patching-on-the-indirect-object-identification-task"]], "Hooks: Accessing Activations": [[1, "hooks-accessing-activations"]], "Available Models": [[1, "available-models"]], "An overview of the important open source models in the library": [[1, "an-overview-of-the-important-open-source-models-in-the-library"]], "An overview of some interpretability-friendly models I\u2019ve trained and included": [[1, "an-overview-of-some-interpretability-friendly-models-i-ve-trained-and-included"]], "Other Resources:": [[1, "other-resources"]], "Transformer architecture": [[1, "transformer-architecture"]], "Parameter Names": [[1, "parameter-names"]], "Activation + Hook Names {#activation\u2013hook-names}": [[1, "activation-hook-names-activation-hook-names"]], "Folding LayerNorm (For the Curious)": [[1, "folding-layernorm-for-the-curious"]], "Features": [[1, "features"]], "Dealing with tokens": [[1, "dealing-with-tokens"]], "Gotcha: prepend_bos": [[1, "gotcha-prepend-bos"]], "Factored Matrix Class": [[1, "factored-matrix-class"]], "Basic Examples": [[1, "basic-examples"]], "Medium Example: Eigenvalue Copying Scores": [[1, "medium-example-eigenvalue-copying-scores"]], "Generating Text": [[1, "generating-text"]], "Hook Points": [[1, "hook-points"]], "Toy Example": [[1, "toy-example"]], "Loading Pre-Trained Checkpoints": [[1, "loading-pre-trained-checkpoints"]], "Example: Induction Head Phase Transition": [[1, "example-induction-head-phase-transition"]]}, "indexentries": {}})