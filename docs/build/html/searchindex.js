Search.setIndex({"docnames": ["index", "test", "test2", "vertopal.com_transformerlensdemo"], "filenames": ["index.rst", "test.md", "test2.rst", "vertopal.com_transformerlensdemo.md"], "titles": ["Welcome to Lumache\u2019s documentation!", "Test", "Test 2", "Transformer Lens Main Demo Notebook"], "terms": {"index": 3, "modul": 3, "search": 3, "page": 3, "hello": 3, "world": 3, "lu": 0, "make": [0, 3], "i": 0, "python": [0, 3], "librari": 0, "cook": 0, "food": 0, "lover": 0, "creat": [0, 3], "recip": 0, "mix": [0, 3], "random": [0, 3], "ingredi": 0, "It": [0, 3], "pull": 0, "data": [0, 3], "from": [0, 3], "open": 0, "fact": [0, 3], "databas": 0, "offer": 0, "simpl": [0, 3], "intuit": [0, 3], "api": 0, "check": [0, 3], "out": [0, 3], "usag": 0, "section": [0, 3], "further": [0, 3], "inform": [0, 3], "includ": 0, "how": [0, 3], "instal": [0, 3], "project": 0, "thi": [0, 3], "under": 0, "activ": 0, "develop": [0, 3], "hi": 3, "test": [0, 3], "asldkalkdsl": 1, "teadsa": [], "test2": [], "2": [0, 3], "transform": 0, "len": 0, "main": 0, "demo": 0, "notebook": 0, "To": 3, "us": 3, "go": 3, "runtim": 3, "chang": 3, "type": 3, "select": 3, "gpu": 3, "hardwar": 3, "acceler": 3, "tip": 3, "read": 3, "colab": 3, "you": 3, "can": 3, "run": 0, "all": 0, "code": 3, "yourself": 3, "The": 3, "graph": 3, "ar": 3, "interact": 3, "tabl": 3, "content": 3, "pane": 3, "sidebar": 3, "navig": 3, "collaps": 3, "irrelev": 3, "dropdown": 3, "arrow": 3, "ctrl": 3, "f": 3, "setup": 0, "No": 3, "need": 3, "janki": 3, "do": 3, "differ": 3, "when": 3, "v": 3, "vscode": 3, "development_mod": 3, "fals": 3, "try": 3, "import": 0, "googl": 3, "in_colab": 3, "true": 3, "print": 3, "pip": 3, "git": 3, "http": 3, "github": 3, "com": 3, "neelnanda": 3, "io": 3, "transformerlen": 3, "circuitsvi": 3, "pysvelt": 3, "an": 0, "unmaintain": 3, "visual": 3, "backup": 3, "isn": 3, "t": 3, "work": 3, "anoth": 3, "version": 3, "node": 3, "wai": 3, "faster": 3, "curl": 3, "fssl": 3, "deb": 3, "nodesourc": 3, "setup_16": 3, "x": 3, "sudo": 3, "e": 3, "bash": 3, "apt": 3, "get": 3, "y": 3, "nodej": 3, "except": 3, "jupyt": 3, "intend": 3, "onli": 3, "ipython": 3, "get_ipython": 3, "automat": 3, "updat": 3, "hookedtransform": 3, "its": 3, "edit": 3, "without": 3, "restart": 3, "kernel": 3, "magic": 3, "load_ext": 3, "autoreload": 3, "plotli": 3, "render": 3, "argh": 3, "pio": 3, "default": 3, "els": 3, "notebook_connect": 3, "cv": 3, "exampl": 0, "neel": 3, "util": 3, "renderedhtml": [], "0x7f96ad0fdcd0": [], "stuff": 3, "torch": 3, "nn": 3, "function": 3, "optim": 3, "numpi": 3, "np": 3, "einop": 3, "fancy_einsum": 3, "einsum": 3, "tqdm": 3, "auto": 3, "pathlib": 3, "path": 3, "express": 3, "px": 3, "dataload": 3, "torchtyp": 3, "tensortyp": 3, "tt": 3, "list": 3, "union": 3, "option": 3, "functool": 3, "partial": 3, "copi": 0, "itertool": 3, "automodelforcausallm": 3, "autoconfig": 3, "autotoken": 3, "dataclass": 3, "dataset": 3, "displai": 3, "html": 3, "transformer_len": 3, "hook_point": 3, "hookedrootmodul": 3, "hookpoint": 3, "hook": 0, "hookedtransformerconfig": 3, "factoredmatrix": 3, "activationcach": 3, "we": 3, "turn": 3, "differenti": 3, "off": 3, "save": 3, "memori": 3, "focus": 3, "model": 0, "infer": 3, "train": 0, "set_grad_en": 3, "autograd": 3, "grad_mod": 3, "0x7f973be365d0": 3, "plot": 3, "helper": 3, "def": [], "imshow": [], "tensor": 3, "none": 3, "xaxi": [], "yaxi": [], "kwarg": [], "to_numpi": [], "color_continuous_midpoint": [], "0": 3, "color_continuous_scal": [], "rdbu": [], "label": 3, "show": 3, "line": 3, "scatter": [], "caxi": [], "color": 3, "introduct": 0, "nanda": 3, "wrote": 3, "mechanist": 3, "interpret": 0, "gpt": 3, "style": 3, "languag": 3, "goal": 3, "take": 3, "revers": 3, "engin": 3, "algorithm": 3, "learn": 3, "dure": 3, "weight": 3, "about": 3, "todai": 3, "have": 3, "comput": 3, "program": 3, "essenti": 3, "speak": 3, "english": 3, "human": 3, "level": 3, "3": 3, "palm": 3, "etc": 3, "yet": 3, "idea": 3, "thei": 3, "nor": 3, "write": 3, "one": 3, "ourselv": 3, "offend": 3, "me": 3, "greatli": 3, "would": 3, "like": 3, "solv": 3, "veri": 3, "young": 3, "small": 3, "field": 3, "lot": 3, "problem": 3, "help": 3, "pleas": 3, "If": 3, "want": 3, "skill": 3, "up": 3, "my": 3, "guid": 3, "start": 3, "jump": 3, "sequenc": 3, "200": 3, "concret": 3, "becaus": 3, "after": 3, "left": 3, "anthrop": 3, "team": 3, "independ": 3, "research": 3, "got": 3, "extrem": 3, "frustrat": 3, "state": 3, "sourc": 0, "tool": 3, "There": 3, "": 3, "excel": 3, "infrastructur": 3, "huggingfac": 3, "deepspe": 3, "littl": 3, "dig": 3, "intern": 3, "tri": 3, "easi": 3, "even": 3, "don": 3, "industri": 3, "org": 3, "real": 3, "core": 3, "featur": 0, "were": 3, "heavili": 3, "inspir": 3, "garcon": 3, "credit": 3, "nelson": 3, "elhag": 3, "chri": 3, "olah": 3, "build": 3, "valu": 3, "good": 3, "exploratori": 3, "design": 3, "principl": 3, "ve": 0, "follow": 3, "enabl": 3, "analysi": 3, "most": 3, "fun": 3, "part": 3, "compar": 3, "normal": 3, "ml": 3, "short": 3, "feedback": 3, "loop": 3, "point": 0, "keep": 3, "gap": 3, "between": 3, "experi": 3, "see": 3, "result": 3, "possibl": 3, "feel": 3, "plai": 3, "enter": 3, "flow": 3, "demonstr": 3, "well": 3, "analys": 3, "indirect": 0, "object": 0, "identif": 0, "record": 3, "myself": 3, "load": 0, "come": 3, "40": 3, "ani": 3, "them": 3, "from_pretrain": 3, "model_nam": 3, "For": 0, "ll": 3, "look": 3, "80m": 3, "paramet": 0, "avail": 0, "info": 3, "rest": 3, "devic": 3, "cuda": 3, "is_avail": [], "cpu": [], "gpt2": 3, "pad_token": 3, "set": 3, "pretrain": 3, "let": 3, "find": 3, "loss": 3, "text": 0, "singl": 3, "string": 3, "token": 0, "shape": 3, "batch": 3, "posit": 3, "integ": 3, "return": 3, "logit": 3, "d_vocab": 3, "float": 3, "cross": 3, "entropi": 3, "predict": 3, "next": 3, "both": 3, "tupl": 3, "calcul": 3, "intermedi": 3, "model_description_text": [], "explain": [], "document": 3, "support": 3, "hyper": 3, "name": 0, "each": 3, "consist": 3, "architectur": 0, "clean": 3, "friendli": 0, "paragraph": 3, "return_typ": [], "4": 3, "1653": 3, "cach": 0, "first": 3, "basic": 0, "oper": 3, "break": 3, "black": 3, "box": 3, "done": 3, "run_with_cach": 3, "abstract": 3, "paper": 3, "On": [], "remove_batch_dim": 3, "everi": 3, "insid": 3, "begin": 3, "dimens": 3, "here": 3, "alwai": 3, "length": 3, "1": 3, "kinda": 3, "annoi": 3, "so": 3, "pass": 3, "keyword": 3, "remov": 3, "gpt2_cache_no_batch_dim": 3, "gpt2_cach": 3, "achiev": 3, "same": 3, "effect": 3, "detail": 3, "gpt2_text": [], "natur": 3, "process": 3, "task": 0, "question": 3, "answer": 3, "machin": [], "translat": 3, "comprehens": [], "summar": [], "typic": [], "approach": [], "supervis": [], "taskspecif": [], "gpt2_token": [], "to_token": 3, "gpt2_logit": [], "attent": 3, "pattern": 3, "head": 0, "layer": 3, "alan": 3, "coonei": 3, "base": 3, "call": 3, "attn": 3, "ha": 3, "head_index": 3, "destination_posit": 3, "source_posit": 3, "to_str_token": 3, "method": 3, "convert": 3, "sinc": 3, "pair": 3, "hover": 3, "over": 3, "click": 3, "lock": 3, "grid": 3, "top": 3, "destin": 3, "lower": 3, "triangular": 3, "causal": 3, "backward": 3, "move": 3, "forward": 3, "network": 3, "more": 3, "what": 3, "attention_pattern": [], "gpt2_str_token": [], "class": 0, "size": 3, "12": 3, "33": 3, "current": 3, "just": 3, "fork": 3, "parallel": 3, "alreadi": 3, "been": 3, "disabl": 3, "avoid": 3, "deadlock": 3, "warn": 3, "either": 3, "befor": 3, "explicitli": 3, "environ": 3, "variabl": 3, "tokenizers_parallel": 3, "0x7f96781e7790": [], "interven": 0, "One": 3, "great": 3, "thing": 3, "neural": 3, "full": 3, "control": 3, "our": 3, "system": 3, "perspect": 3, "know": 3, "exactli": 3, "mean": 3, "And": 3, "precis": 3, "surgic": 3, "behaviour": 3, "other": 0, "power": 3, "u": 3, "eg": 3, "care": 3, "counterfactu": 3, "intervent": 3, "easili": 3, "understand": 3, "accordingli": 3, "being": 3, "abl": 3, "pretti": 3, "kei": 3, "surround": 3, "which": 3, "allow": 3, "ad": 3, "map": 3, "current_activation_valu": 3, "new_activation_valu": 3, "As": 3, "appli": 3, "replac": 3, "substitut": 3, "arbitrari": 3, "long": 3, "correct": 3, "relationship": 3, "pytorch": 3, "blog": [], "paperspac": [], "gradient": [], "clip": [], "debug": [], "underr": [], "incredibli": [], "act": 3, "input": 3, "output": 3, "autodiff": [], "within": 3, "structur": 3, "immedi": 3, "clear": [], "adjust": [], "wa": 3, "shamelessli": [], "probepoint": [], "circuit": 3, "pub": [], "2021": [], "also": 3, "rang": 3, "qualiti": [], "life": [], "improv": 3, "reset_hook": 3, "temporarili": 3, "add": 3, "shoot": 3, "foot": 3, "standard": 3, "ablat": 3, "7": 3, "abov": 3, "defin": 3, "head_ablation_hook": 3, "compon": 3, "zero": 3, "note": 3, "convent": 3, "re": 3, "place": 3, "strictli": 3, "run_with_hook": 3, "found": 3, "get_act_nam": 3, "layer_to_abl": [], "head_index_to_abl": [], "8": 3, "annot": [], "NOT": [], "necessari": 3, "reader": [], "po": [], "d_head": 3, "original_loss": [], "ablated_loss": [], "fwd_hook": [], "origin": 3, "item": [], "3f": [], "64": 3, "999": 3, "117": 3, "gotcha": 0, "global": 3, "stai": 3, "until": 3, "where": 3, "local": 3, "end": 3, "But": 3, "error": 3, "your": 3, "never": 3, "finish": 3, "bug": 3, "own": 3, "add_hook": 3, "relev": 3, "patch": 0, "somewhat": 3, "involv": 3, "ioi": 3, "identifi": 3, "sentenc": 3, "john": 3, "mari": 3, "went": 3, "store": 3, "gave": 3, "bottl": 3, "milk": 3, "rather": 3, "than": 3, "ie": 3, "redwood": 3, "studi": 3, "underli": 3, "techniqu": 3, "kevin": 3, "meng": 3, "david": 3, "bau": 3, "rome": 3, "complet": 3, "prompt": 3, "corrupt": 3, "metric": 3, "perform": 3, "pick": 3, "specif": 3, "much": 3, "recov": 3, "incorrect": 3, "final": 3, "significantli": 3, "neg": 3, "capabl": 3, "clean_prompt": [], "corrupted_prompt": [], "clean_token": [], "corrupted_token": [], "logits_to_logit_diff": [], "correct_answ": [], "incorrect_answ": [], "to_single_token": 3, "rais": [], "correct_index": [], "incorrect_index": [], "later": [], "clean_logit": [], "clean_cach": [], "clean_logit_diff": [], "corrupted_logit": [], "corrupted_logit_diff": [], "276": 3, "738": 3, "now": 3, "residu": 3, "stream": 3, "repres": 3, "iter": 3, "must": 3, "signatur": 3, "choos": 3, "resid_pr": [], "residual_stream_patching_hook": [], "d_model": 3, "int": [], "attribut": [], "give": 3, "clean_resid_pr": [], "put": 3, "slow": [], "num_posit": [], "ioi_patching_result": [], "cfg": [], "n_layer": 3, "temporari": [], "fix": 3, "temp_hook_fn": [], "patched_logit": [], "patched_logit_diff": [], "detach": [], "ish": 3, "version_major": [], "version_minor": [], "model_id": [], "69225f8c0e1949b8a900aa73abcdd5d4": [], "localis": 3, "initi": 3, "second": 3, "subject": 3, "matter": 3, "remain": 3, "9": 3, "doesn": 3, "duplic": [], "token_label": [], "_": 3, "enumer": [], "titl": [], "access": 0, "some": 0, "noth": 3, "extract": 3, "across": 3, "mani": 3, "neuron": 3, "everyth": 3, "could": 3, "post": 3, "workflow": 3, "effici": 3, "induct": 0, "gener": 0, "detect": 3, "continu": 3, "repeat": 3, "subsequ": 3, "two": 3, "separ": 3, "compos": 3, "togeth": 3, "previou": 3, "attend": 3, "earlier": 3, "why": 3, "sai": 3, "new": 3, "articl": 3, "michael": 3, "jordan": 3, "surnam": 3, "occur": 3, "confid": 3, "interest": 3, "generalis": 3, "50": 3, "twice": 3, "averag": 3, "goe": 3, "terribl": 3, "halfwai": 3, "batch_siz": [], "10": 3, "seq_len": 3, "random_token": [], "randint": [], "1000": 3, "10000": [], "repeated_token": [], "repeated_logit": [], "correct_log_prob": [], "loss_fn": [], "per_token": [], "loss_by_posit": [], "reduc": [], "49": 3, "back": 3, "paid": 3, "technic": 3, "attach": 3, "big": 3, "per": 3, "stack": [], "manipul": [], "score": 0, "appropri": [], "time": 3, "filter": 3, "boolean": 3, "evalu": [], "act_nam": [], "hook_funct": [], "onc": [], "induction_score_stor": [], "n_head": 3, "induction_score_hook": [], "dest_po": [], "source_po": [], "diagon": [], "entri": [], "induction_strip": [], "dim1": [], "dim2": [], "offset": [], "induction_scor": [], "pattern_hook_names_filt": [], "lambda": [], "endswith": [], "5": 3, "highli": 3, "feed": 3, "shorter": 3, "directli": 3, "stripe": 3, "induction_head_lay": [], "induction_head_index": [], "single_random_sequ": [], "20": 3, "repeated_random_sequ": [], "visualize_pattern_hook": [], "dummi": [], "axi": 3, "expect": 3, "3d": [], "0x7f96783b37d0": [], "toi": 0, "tini": 3, "four": 3, "solu": 3, "medium": 0, "300m": 3, "offici": 3, "alia": 3, "doe": 3, "multi": 3, "7b": 3, "soon": 3, "notabl": 3, "distilgpt": 3, "distil": 3, "half": 3, "distilgpt2": 3, "distilgpt2_induction_score_stor": [], "overview": 0, "classic": 3, "pre": 0, "openai": 3, "85m": 3, "larg": 3, "700m": 3, "xl": 3, "5b": 3, "22b": 3, "internet": 3, "replic": 3, "neo": 3, "eleuth": 3, "125m": 3, "3b": 3, "300b": 3, "pile": 3, "divers": 3, "bunch": 3, "weird": 3, "opt": 3, "meta": 3, "ai": 3, "seri": 3, "180b": 3, "6": 3, "13b": 3, "30b": 3, "66b": 3, "j": 3, "6b": 3, "neox": 3, "20b": 3, "stanford": 3, "crfm": 3, "seed": 3, "600": 3, "checkpoint": 0, "taken": 3, "checkpoint_index": 3, "265": 3, "free": 3, "reach": 3, "argument": 3, "given": 3, "A": 3, "mathemat": 3, "framework": 3, "4l": 3, "width": 3, "512": 3, "think": 3, "far": 3, "tractabl": 3, "larger": 3, "serv": 3, "practic": 3, "contain": 3, "motif": 3, "mlp": 3, "1l": 3, "2l": 3, "3l": 3, "gelu": 3, "80": 3, "c4": 3, "web": 3, "shuffl": 3, "scan": 3, "hope": 3, "easier": 3, "6l": 3, "40m": 3, "8l": 3, "100m": 3, "10l": 3, "200m": 3, "12l": 3, "340m": 3, "older": 3, "15b": 3, "13m": 3, "resourc": 0, "doc": 3, "thought": 3, "low": 3, "hang": 3, "fruit": 3, "peopl": 3, "usefulli": 3, "progress": 3, "toolkit": 3, "explor": 3, "mysteri": 3, "wild": 3, "codebas": 3, "arthur": 3, "conmi": 3, "alex": 3, "variengien": 3, "rigor": 3, "accompani": 3, "easytransform": 3, "similar": 3, "sever": 3, "made": 3, "walkthrough": 3, "whether": 3, "deriv": 3, "neuroscop": 3, "websit": 3, "sens": 3, "kind": 3, "tend": 3, "wiki": 3, "tutori": 3, "live": 3, "adapt": 3, "computation": 3, "ident": 3, "signific": 3, "w_k": 3, "w_q": 3, "w_v": 3, "queri": 3, "matric": 3, "concaten": 3, "w_o": 3, "z": 3, "ax": 3, "flatten": 3, "actual": 3, "bit": 3, "mess": 3, "varieti": 3, "flag": 3, "variou": 3, "famili": 3, "instead": 3, "recommend": 3, "cleantransformerdemo": 3, "By": 3, "multipli": 3, "right": 3, "new_activ": 3, "old_activ": 3, "bia": 3, "remind": 3, "param": 3, "number": 3, "block": 3, "768": 3, "d_mlp": 3, "3072": 3, "50267": 3, "vocabulari": 3, "n_ctx": 3, "1024": 3, "maximum": 3, "named_paramet": [], "startswith": [], "b_q": 3, "b_k": 3, "b_v": 3, "b_o": 3, "w_in": 3, "b_in": 3, "w_out": 3, "b_out": 3, "embed": 3, "unembed": 3, "emb": 3, "w_e": 3, "50257": 3, "pos_emb": 3, "w_po": 3, "unemb": 3, "w_u": 3, "b_u": 3, "In": 3, "fallback": 3, "spam": 3, "layernorm": 0, "scale": 3, "factor": 0, "deviat": 3, "element": 3, "ln1": 3, "ln2": 3, "ln_final": 3, "apart": 3, "dest_posit": 3, "unless": 3, "test_prompt": [], "quick": [], "brown": [], "fox": [], "lazi": [], "dog": [], "num": 3, "print_name_shape_hook_funct": [], "not_in_late_block_filt": [], "hook_emb": 3, "hook_pos_emb": 3, "hook_resid_pr": 3, "hook_scal": 3, "hook_norm": 3, "hook_q": 3, "hook_k": 3, "hook_v": 3, "hook_attn_scor": 3, "hook_pattern": 3, "hook_z": 3, "hook_attn_out": 3, "hook_resid_mid": 3, "hook_pr": 3, "hook_post": 3, "hook_mlp_out": 3, "hook_resid_post": 3, "fold": 0, "curiou": 0, "worth": 3, "especi": 3, "preconcept": 3, "analog": 3, "batchnorm": 3, "massiv": 3, "parallelis": 3, "realli": 3, "seem": 3, "numer": 3, "stabil": 3, "unlik": 3, "form": 3, "pain": 3, "overhead": 3, "deal": 0, "center_writing_weight": 3, "fold_ln": 3, "These": 3, "simplifi": 3, "vector": 3, "center": 3, "elementwis": 3, "linear": 3, "matrix": 0, "cannot": 3, "composit": 3, "consequ": 3, "particular": 3, "unigram": 3, "statist": 3, "rare": 3, "suppress": 3, "common": 3, "boost": 3, "dramat": 3, "degre": 3, "bottom": 3, "punctuat": 3, "word": 3, "ass": 3, "randomredditor": 3, "unembed_bia": [], "bias_valu": [], "bias_indic": [], "sort": [], "descend": [], "top_k": [], "2f": [], "repr": [], "to_str": 3, "03": 3, "98": 3, "68": 3, "48": 3, "n": 3, "47": 3, "41": 3, "25": 3, "16": 3, "04": 3, "88": 3, "72": 3, "59": 3, "52": 3, "45": 3, "44": 3, "82": 3, "\u30b5\u30fc\u30c6\u30a3": 3, "83": 3, "x18": 3, "x14": 3, "\u9f8d": 3, "x1b": 3, "x05": 3, "x00": 3, "x06": 3, "x07": 3, "x0c": 3, "x02": 3, "oreandonlin": 3, "84": 3, "x11": 3, "x10": 3, "favour": 3, "6x": 3, "john_bia": [], "mary_bia": [], "4f": [], "prob": 3, "ratio": 3, "exp": [], "8995": 3, "6034": 3, "6550x": 3, "mention": 3, "finit": 3, "solut": 3, "sub": 3, "broken": 3, "down": 3, "invert": 3, "de": 3, "get_token_posit": 3, "prepend_bo": 0, "figur": 3, "split": 3, "substr": 3, "observ": 3, "space": 3, "preced": 3, "capit": 3, "letter": 3, "fairli": 3, "while": 3, "uncommon": 3, "multipl": 3, "iz": 3, "mostli": 3, "charact": 3, "example_text": [], "example_text_str_token": [], "endoftext": 3, "str": 3, "ok": 3, "en": 3, "example_text_token": [], "50256": 3, "464": 3, "717": 3, "1517": 3, "345": 3, "761": 3, "284": 3, "3785": 3, "503": 3, "318": 3, "1635": 3, "4919": 3, "1243": 3, "389": 3, "11241": 3, "1143": 3, "13": 3, "4600": 3, "19849": 3, "1462": 3, "62": 3, "2536": 3, "482": 3, "641": 3, "63": 3, "30778": 3, "257": 3, "4731": 3, "656": 3, "262": 3, "16326": 3, "292": 3, "1351": 3, "286": 3, "850": 3, "37336": 3, "25666": 3, "290": 3, "523": 3, "8781": 3, "7301": 3, "644": 3, "2420": 3, "3073": 3, "588": 3, "1675": 3, "10176": 3, "428": 3, "11": 3, "1309": 3, "338": 3, "779": 3, "340": 3, "319": 3, "7322": 3, "pad": 3, "signifi": 3, "example_multi_text": [], "cat": 3, "sat": 3, "mat": 3, "hard": 3, "example_multi_text_token": [], "3797": 3, "3332": 3, "2603": 3, "1107": 3, "1327": 3, "conveni": 3, "correspond": 3, "log": 3, "implicitli": 3, "equival": [], "k": [], "cheat": [], "th": [], "treat": 3, "cat_text": [], "cat_logit": [], "cat_prob": [], "softmax": [], "dim": 3, "probabl": 3, "capital_the_token_index": [], "invers": 3, "256": 3, "due": 3, "ascii": 3, "verifi": 3, "squeez": [], "rank": 3, "relat": 3, "annoy": 3, "single_token": 3, "third": 3, "prepend": 3, "With": 3, "bo": 3, "mode": 3, "last": 3, "around": 3, "arithmet": 3, "digit": 3, "impress": 3, "2342": [], "2017": 3, "21445": [], "1000000": [], "999999": [], "23": 3, "42": 3, "214": 3, "000000": 3, "9999": 3, "99": 3, "investig": 3, "ideal": 3, "should": 3, "total": 3, "tim": 3, "ne": 3, "el": 3, "spend": 3, "earli": 3, "late": 3, "messier": 3, "takeawai": 3, "unexpect": 3, "mai": 3, "notic": 3, "trip": 3, "user": 3, "special": 3, "mark": 3, "confusingli": 3, "eo": 3, "hack": 3, "gone": 3, "forth": 3, "reason": 3, "weirdli": 3, "issu": 3, "distribut": 3, "simul": 3, "preserv": 3, "despit": 3, "empir": 3, "wors": 3, "ioi_logits_with_bo": [], "clair": 3, "shop": [], "mary_logit_with_bo": [], "claire_logit_with_bo": [], "ioi_logits_without_bo": [], "mary_logit_without_bo": [], "claire_logit_without_bo": [], "754": 3, "782": 3, "though": 3, "illustr": 3, "confus": 3, "cl": 3, "air": 3, "often": 3, "m": 3, "ab": 3, "b": 3, "implement": 3, "trace": 3, "eigenvalu": 0, "frobeniu": 3, "norm": 3, "singular": 3, "decomposit": 3, "product": 3, "approxim": 3, "drop": 3, "lead": 3, "argu": [], "best": [], "understood": [], "requisit": [], "w_qk": [], "determin": 3, "attention_scor": [], "whole": [], "bilinear": [], "w_ov": 3, "ignor": [], "smaller": [], "randn": [], "ab_factor": [], "rdim": [], "ldim": [], "hidden": 3, "mdim": [], "7439": 3, "omit": 3, "linalg": [], "eig": [], "svd": [], "6199e": 3, "00": 3, "0000e": 3, "00j": 3, "0446e": 3, "7190e": 3, "08": 3, "5998e": 3, "2859e": 3, "07j": 3, "6199": 3, "0446": 3, "4702e": 3, "7519e": 3, "4613e": 3, "07": 3, "0601e": 3, "8823e": 3, "09": 3, "4702": 3, "7519": 3, "smallest": 3, "along": 3, "c": [], "300": 3, "abc": [], "abc_factor": [], "unfactor": 3, "9906": 3, "properti": 3, "ab_unfactor": [], "isclos": [], "skip": 3, "aren": 3, "ov": 3, "factoris": 3, "subspac": 3, "mayb": 3, "happen": 3, "middl": 3, "minim": 3, "coincid": 3, "assert": 3, "eigenvector": 3, "direct": 3, "rotat": 3, "complex": 3, "negat": 3, "decent": 3, "proxi": 3, "frac": 3, "sum": 3, "lambda_i": 3, "ov_circuit_all_head": [], "ov_circuit_all_heads_eigenvalu": [], "dtype": [], "complex64": 3, "ov_copying_scor": [], "zmax": [], "zmin": [], "l11h11": 3, "high": 3, "imag": [], "imaginari": [], "absolut": 3, "enorm": 3, "few": 3, "full_ov_circuit": [], "full_ov_circuit_eigenvalu": [], "full_ov_copying_scor": [], "interestingli": 3, "perfectli": 3, "correl": 3, "sure": 3, "outlier": 3, "hover_nam": [], "l": [], "h": [], "thank": 3, "ansh": 3, "radhakrishnan": 3, "rough": 3, "establish": 3, "cnn": 3, "presid": 3, "barack": 3, "obama": 3, "caught": 3, "embarrass": 3, "scandal": 3, "max_new_token": [], "temperatur": [], "9c541056beba477db0a272faec9231b5": [], "ncnn": 3, "report": 3, "wednesdai": 3, "former": 3, "charg": 3, "ly": 3, "fbi": 3, "russian": 3, "employe": 3, "nthe": 3, "said": 3, "statement": 3, "had": 3, "conduct": 3, "nobama": 3, "plead": 3, "importantli": 3, "lightweight": 3, "bundl": 3, "wrap": 3, "root": 3, "inherit": 3, "interfac": 3, "syntax": 3, "old": 3, "scalar": 3, "squar": 3, "constant": 3, "x_0": 3, "x_1": 3, "x_2": 3, "squarethenadd": [], "__init__": [], "self": [], "super": [], "hook_squar": 3, "twolayermodel": [], "layer1": 3, "layer2": 3, "hook_in": 3, "hook_mid": 3, "hook_out": 3, "dictionari": 3, "leav": [], "unchang": [], "x_in": [], "x_mid": [], "x_out": [], "custom": 3, "wrapper": 3, "model_out": 3, "cache_object": 3, "manual": 3, "subset": 3, "780": 3, "28": 3, "784": 3, "set_to_zero_hook": [], "combin": 3, "dynam": 3, "throughout": 3, "num_checkpoint": 3, "checkpoint_valu": 3, "step": 3, "depend": 3, "piecewis": 3, "schedul": 3, "seen": 3, "100": 3, "crash": 3, "11b": 3, "truncat": 3, "centr": 3, "foundat": 3, "messi": 3, "hoc": 3, "count": 3, "get_checkpoint_label": 3, "tell": 3, "latter": 3, "loading_from_pretrain": [], "checkpoint_label": [], "checkpoint_label_typ": [], "log_i": [], "marker": [], "phase": 0, "transit": 0, "format": 3, "shift": 3, "brief": 3, "period": 3, "suddenli": 3, "becom": 3, "better": 3, "context": 3, "500": 3, "enough": 3, "visibl": 3, "bump": 3, "curv": 3, "rate": 3, "briefli": 3, "increas": 3, "exist": 3, "eval": 3, "induction_loss": 3, "deliber": 3, "non": 3, "purpos": 3, "384": 3, "justic": 3, "hand": 3, "chosen": 3, "indic": 3, "35": 3, "60": 3, "roughli": 3, "22m": 3, "500m": 3, "21": 3, "8b": 3, "through": 3, "respect": 3, "arbitrarili": [], "fast": [], "download": [], "specifi": [], "checkpoint_indic": [], "checkpointed_model": [], "tokens_trained_on": [], "model_for_this_checkpoint": [], "append": [], "tokens_seen_for_this_checkpoint": [], "induction_loss_for_this_checkpoint": [], "sharp": 3, "contextualis": 3, "uniformli": 3, "000": 3, "least": 3, "ln": 3, "20000": 3, "approx": 3, "naiv": 3, "strategi": 3, "randomli": 3, "appear": 3, "95": 3, "log_x": [], "cell": 3, "markdown": 3, "red": 3, "execution_count": 3, "stdout": 3, "execute_result": 3, "stderr": 3, "14": 3, "15": 3, "display_data": 3, "17": 3, "18": 3, "19": 3, "22": 3, "24": 3, "26": 3, "27": 3, "29": 3, "30": 3, "31": 3, "32": 3, "34": 3, "36": 3, "37": 3, "38": 3, "39": 3, "43": 3, "46": 3, "51": 3, "53": 3, "54": 3, "55": 3, "56": 3, "57": 3, "58": 3, "div": 3, "id": 3, "vi": 3, "056bcb82": 3, "ac45": 3, "margin": 3, "15px": 3, "script": 3, "crossorigin": 3, "unpkg": 3, "dist": 3, "cdn": 3, "esm": 3}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": 0, "jdbowma": [], "transform": 3, "len": 3, "doc": [], "": 0, "document": 0, "indic": [], "tabl": [], "lumach": 0, "content": 0, "your": [], "mama": [], "test2": [], "test": [1, 2], "2": 2, "main": 3, "demo": 3, "notebook": 3, "setup": 3, "introduct": 3, "load": 3, "run": 3, "model": 3, "cach": 3, "all": 3, "activ": 3, "hook": 3, "interven": 3, "patch": 3, "indirect": 3, "object": 3, "identif": 3, "task": 3, "access": 3, "avail": 3, "an": 3, "overview": 3, "import": 3, "open": 3, "sourc": 3, "librari": 3, "some": 3, "interpret": 3, "friendli": 3, "i": 3, "ve": 3, "train": 3, "includ": 3, "other": 3, "resourc": 3, "architectur": 3, "paramet": 3, "name": 3, "fold": 3, "layernorm": 3, "For": 3, "curiou": 3, "featur": 3, "deal": 3, "token": 3, "gotcha": 3, "prepend_bo": 3, "factor": 3, "matrix": 3, "class": 3, "basic": 3, "exampl": 3, "medium": 3, "eigenvalu": 3, "copi": 3, "score": 3, "gener": 3, "text": 3, "point": 3, "toi": 3, "pre": 3, "checkpoint": 3, "induct": 3, "head": 3, "phase": 3, "transit": 3, "janki": [], "code": [], "do": [], "differ": [], "when": [], "colab": [], "v": [], "vscode": []}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Test 2": [[2, "test-2"]], "Test": [[1, "test"]], "Welcome to Lumache\u2019s documentation!": [[0, "welcome-to-lumache-s-documentation"]], "Contents": [[0, "contents"]], "Transformer Lens Main Demo Notebook": [[3, "transformer-lens-main-demo-notebook"]], "Setup": [[3, "setup"]], "Introduction": [[3, "introduction"]], "Loading and Running Models": [[3, "loading-and-running-models"]], "Caching all Activations": [[3, "caching-all-activations"]], "Hooks: Intervening on Activations": [[3, "hooks-intervening-on-activations"]], "Activation Patching on the Indirect Object Identification Task": [[3, "activation-patching-on-the-indirect-object-identification-task"]], "Hooks: Accessing Activations": [[3, "hooks-accessing-activations"]], "Available Models": [[3, "available-models"]], "An overview of the important open source models in the library": [[3, "an-overview-of-the-important-open-source-models-in-the-library"]], "An overview of some interpretability-friendly models I\u2019ve trained and included": [[3, "an-overview-of-some-interpretability-friendly-models-i-ve-trained-and-included"]], "Other Resources:": [[3, "other-resources"]], "Transformer architecture": [[3, "transformer-architecture"]], "Parameter Names": [[3, "parameter-names"]], "Activation + Hook Names {#activation\u2013hook-names}": [[3, "activation-hook-names-activation-hook-names"]], "Folding LayerNorm (For the Curious)": [[3, "folding-layernorm-for-the-curious"]], "Features": [[3, "features"]], "Dealing with tokens": [[3, "dealing-with-tokens"]], "Gotcha: prepend_bos": [[3, "gotcha-prepend-bos"]], "Factored Matrix Class": [[3, "factored-matrix-class"]], "Basic Examples": [[3, "basic-examples"]], "Medium Example: Eigenvalue Copying Scores": [[3, "medium-example-eigenvalue-copying-scores"]], "Generating Text": [[3, "generating-text"]], "Hook Points": [[3, "hook-points"]], "Toy Example": [[3, "toy-example"]], "Loading Pre-Trained Checkpoints": [[3, "loading-pre-trained-checkpoints"]], "Example: Induction Head Phase Transition": [[3, "example-induction-head-phase-transition"]]}, "indexentries": {}})